$(document).ready(function () {
  // Efeito de fade-in nas seções ao rolar a página
  function handleFadeIn() {
    $(".fade-in").each(function () {
      var elementTop = $(this).offset().top;
      var windowBottom = $(window).scrollTop() + $(window).height();
      if (windowBottom > elementTop) {
        $(this).addClass("visible");
      }
    });
  }

  // Botão de voltar ao topo com posicionamento responsivo
  var backToTop = $('<button id="back-to-top">▲</button>').appendTo("body");
  backToTop.hide().css({
    position: "fixed",
    bottom: "20px",
    right: "20px",
    padding: "10px 15px",
    background: "#008080",
    color: "#fff",
    border: "none",
    cursor: "pointer",
    "border-radius": "5px",
    "font-size": "16px",
    "z-index": "999",
    "transition": "all 0.3s ease-in-out",
  });

  // Menu mobile toggle
  var menuToggle = $('<button class="menu-toggle">☰</button>').prependTo(".main-nav");
  menuToggle.css({
    display: "none",
    background: "transparent",
    border: "none",
    color: "#008080",
    fontSize: "24px",
    cursor: "pointer",
    padding: "10px",
  });

  // Função para ajustar o menu baseado no tamanho da tela
  function handleResponsiveMenu() {
    if ($(window).width() <= 767) {
      menuToggle.css("display", "block");
      $(".main-nav nav").hide();
    } else {
      menuToggle.css("display", "none");
      $(".main-nav nav").show();
    }
  }

  // Toggle do menu mobile
  menuToggle.on("click", function() {
    $(".main-nav nav").slideToggle(300);
  });

  // Fechar menu ao clicar em um link (mobile)
  $(".main-nav nav a").on("click", function() {
    if ($(window).width() <= 767) {
      $(".main-nav nav").slideUp(300);
    }
  });

  // Scroll suave para links internos
  $('a[href^="#"]').on("click", function (event) {
    event.preventDefault();
    var target = $(this.getAttribute("href"));
    if (target.length) {
      var offset = $(window).width() <= 767 ? 70 : 100;
      $("html, body").animate({
        scrollTop: target.offset().top - offset
      }, 600);
    }
  });

  // Header fixo responsivo
  var header = $(".main-header");
  var headerHeight = header.outerHeight();
  
  function handleStickyHeader() {
    if ($(window).scrollTop() > headerHeight) {
      header.addClass("sticky");
      $("body").css("padding-top", headerHeight);
    } else {
      header.removeClass("sticky");
      $("body").css("padding-top", 0);
    }
  }

  // Botão voltar ao topo
  function handleBackToTop() {
    if ($(window).scrollTop() > 300) {
      backToTop.fadeIn();
    } else {
      backToTop.fadeOut();
    }
  }

  // Animação de hover nos elementos
  $(".btn, .service-box, .post").hover(
    function () {
      $(this).css({
        transform: "translateY(-5px)",
        transition: "transform 0.3s ease"
      });
    },
    function () {
      $(this).css({
        transform: "translateY(0)",
        transition: "transform 0.3s ease"
      });
    }
  );

  // Event handlers
  $(window).on({
    scroll: function() {
      handleStickyHeader();
      handleBackToTop();
      handleFadeIn();
    },
    resize: function() {
      handleResponsiveMenu();
      handleStickyHeader();
    },
    load: function() {
      handleResponsiveMenu();
      handleStickyHeader();
      // Fade in inicial dos elementos
      $(".fade-load").css("opacity", 1);
    }
  });

  // Voltar ao topo
  backToTop.on("click", function () {
    $("html, body").animate({ scrollTop: 0 }, 500);
  });

  // Manipulador de clique para o email
  $('.contact-main a[href^="mailto:"]').on('click', function(event) {
    event.preventDefault();
    var email = 'thaisalvespimenta@outlook.com.br';
    var subject = 'Contato via Site';
    var body = 'Olá, gostaria de mais informações sobre os serviços.';
    
    window.location.href = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
  });
});
